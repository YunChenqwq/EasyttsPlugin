[plugin]
enabled = true # 是否启用插件
config_version = "0.1.0" # 配置版本（请勿修改）
tips = "请不要在bot自己的webui中编辑配置文件，请打开文件编辑。" # 重要提示（WebUI 会显示这个字段）

[general]
tts_mode = "fixed" # TTS 模式：free=自由模式（交给 LLM 决定是否用语音）；fixed=固定模式（逐句翻译并逐句发送语音）
default_backend = "easytts" # 默认后端（本插件仅支持 easytts）
timeout = 60 # Action/Command 总体超时（秒）
max_text_length = 120 # 最大文本长度（超过会降级为文字回复；语音建议更短）
use_replyer_rewrite = false # 语音文案由 Planner/LLM 直接提供（避免二次生成导致啰嗦/失控）
audio_output_dir = "" # 音频输出目录（留空使用项目根目录；use_base64_audio=true 时一般不落盘）
use_base64_audio = false # 关闭：用本地文件路径发送（voiceurl），更稳定（避免超长 base64）
split_sentences = false # 已在后端 remote_split_sentence 做分句合成；避免“一个消息多条语音”
split_delay = 0.0 # 分句发送已关闭
send_error_messages = true # 失败时是否给用户发送错误提示
send_text_along_with_voice = true # 使用 unified_tts_action 时是否先发文字再发语音（推荐开启：避免文本/语音不一致）
voice_translate_to = "ja" # 语音合成前是否翻译文字（默认 ja=日语；留空/none/off 表示不翻译，直接用原文合成）
force_text_language = "zh" # 强制“发出去的文字”语言：zh=始终发中文（避免把日语译文直接发出去）；留空=不强制
fixed_mode_infer_emotion = true # 固定模式：是否逐句调用 LLM 选择 preset（只会从该角色已有 presets 中选）

[components]
action_enabled = true # 是否启用 Action（关键词触发自动语音回复）
command_enabled = true # 是否启用 Command（手动命令：/eztts）

[easytts]
default_character = "sagiri" # 默认角色（character）
default_preset = "普通" # 默认预设（preset）
auto_fetch_gradio_schema = true # 插件启动时自动抓 /gradio_api/info 同步角色/预设列表（让 LLM 只用真实存在的 preset）
schema_cache_ttl = 86400 # schema 缓存有效期（秒，0=每次启动都抓取）
schema_cache_file = "_gradio_schema_cache.json" # schema 缓存文件名（相对插件目录；留空则不落盘缓存）

# 是否让远端也进行“分句合成”（Gradio 入参 split_sentence）
remote_split_sentence = true
# 是否优先选择更空闲的仓库（依据 queue/status 的 queue_size）
prefer_idle_endpoint = true
# 繁忙阈值：queue_size > 该值视为忙（0=只有 queue_size==0 才算空闲）
busy_queue_threshold = 0

# /gradio_api/queue/status 超时（秒）
status_timeout = 3
# /gradio_api/queue/join 超时（秒）
join_timeout = 30
# /gradio_api/queue/data（SSE）超时（秒）
sse_timeout = 120
# 音频下载超时（秒）
download_timeout = 120

# aiohttp 是否继承系统代理（Windows 环境常见代理导致连接问题，建议 false）
trust_env = false

[[easytts.characters]]
name = "mika" # 角色名（对应 WebUI 的 character 下拉值）
presets = ["普通", "开心", "伤心", "生气", "害怕", "害羞", "惊讶", "认真", "疑问", "痛苦", "百感交集释然"] # 该角色可用的预设列表（对应 WebUI 的 preset 下拉值）

[[easytts.characters]]
name = "sagiri" # 新角色示例：和泉纱雾（预设与 mika 一致，可按需修改为你的模型实际预设）
# 注意：这里的 presets 必须是你实际部署的 easytts WebUI 里存在的 preset 名称。
# 推荐：开启 easytts.auto_fetch_gradio_schema=true，让插件启动时自动从 Gradio 抓取最新角色/预设枚举并覆盖这里的 presets。
presets = ["普通", "开心", "伤心", "生气", "疑问", "惊讶", "百感交集的释然"]

[[easytts.characters]]
name = "character3" # 预留槽位 3（请改成你自己的角色名）
presets = ["普通"]

[[easytts.characters]]
name = "character4" # 预留槽位 4
presets = ["普通"]

[[easytts.characters]]
name = "character5" # 预留槽位 5
presets = ["普通"]

[[easytts.endpoints]]
name = "default" # 仓库名（自定义，用于日志）
base_url = "https://yunchenqwq-easytts.ms.show" # Gradio 基地址（例如 https://xxx.ms.show）
studio_token = "8d818e3b-58c6-4707-96d9-b3e64af312f4" # studio_token（必填）
fn_index = 3 # 触发合成的 fn_index（不同部署可能不同）
trigger_id = 19 # 触发合成的 trigger_id（不同部署可能不同）

[[easytts.endpoints]]
name = "pool-2"
base_url = ""
studio_token = ""
fn_index = 3
trigger_id = 19

[[easytts.endpoints]]
name = "pool-3"
base_url = ""
studio_token = ""
fn_index = 3
trigger_id = 19

[[easytts.endpoints]]
name = "pool-4"
base_url = ""
studio_token = ""
fn_index = 3
trigger_id = 19

[[easytts.endpoints]]
name = "pool-5"
base_url = ""
studio_token = ""
fn_index = 3
trigger_id = 19
